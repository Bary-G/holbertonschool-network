#!/usr/bin/env bash
# Configure an Ubuntu server with two IP addresses

set -euo pipefail

backup_file="/etc/hosts.bak.$(date +%F-%H%M%S)"

cp /etc/hosts "$backup_file"

sed -i '/^127\.0\.0\.1[[:space:]]\+localhost/d' /etc/hosts

printf "127.0.0.1\tlocalhost\n" >> /etc/hosts

if ! grep -q "^127\.0\.0\.2" /etc/hosts; then
    printf "127.0.0.2\tlocalhost2\n" >> /etc/hosts
fi

printf "127.0.0.1\tfacebook.com\n" >> /etc/hosts

grep "localhost" /etc/hosts
